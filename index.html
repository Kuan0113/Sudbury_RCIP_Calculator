<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sudbury RCIP Scoring Calculator</title>
<style>
  body { font-family: Arial, sans-serif; margin: 2rem; text-align: center; }
  h1 { color: #24292e; }
  h2 { margin-top: 2rem; color: #0366d6; }
  label { display: block; margin-top: 0.5rem; }
  select, .checkbox-group { width: 300px; padding: 0.5rem; margin-top: 0.3rem; text-align: left; }
  button, a.button {
    margin-top: 1.5rem;
    padding: 0.7rem 1.2rem;
    font-size: 1rem;
    background-color: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    text-decoration: none;
    display: inline-block;
    transition: background 0.3s;
  }
  button:hover, a.button:hover { background-color: #024ea2; }
  #result { margin-top: 1.5rem; font-weight: bold; font-size: 1.2rem; }
  .checkbox-group label { display: block; margin: 0.2rem 0; }
  #details { display: none; margin-top: 1rem; text-align: left; max-width: 600px; margin-left: auto; margin-right: auto; }
</style>
</head>
<body>
<h1>Sudbury RCIP Scoring Calculator</h1>

<div id="calculator"></div>

<button onclick="calculatePoints()">Calculate Points</button>
<button onclick="toggleDetails()">Show Details</button>
<a class="button" href="https://investsudbury.ca/programs/rural-community-immigration-pilot/" target="_blank">RCIP Info</a>

<div id="result"></div>
<div id="details"></div>

<script>
// 分區類別與選項
const categories = {
  "Job Offer - Section": ["Natural and Applied Sciences", "Health", "Education, Social, Community and Government Services", "Trades and Transport", "Natural Resources and Agriculture"],
  "Job Offer - Occupation": [
    "Mining Engineers (21330)", "Mechanical Engineers (21301)", "Geological Engineers (21331)", "Civil Engineering Technologists and Technicians (22300)", 
    "Mechanical Engineering Technologists and Technicians (22301)", "Electrical and Electronics Engineering Technologists and Technicians (22310)",
    "Physiotherapists (31202)", "Registered Nurses (31301)", "Registered Practical Nurses (32101)", "Social and Community Service Workers (42201)",
    "Early Childhood Educators and Assistants (42202)", "Heavy Duty Equipment Mechanics (72401)", 
    "Automotive Service Technicians, Truck and Bus Mechanics, and Mechanical Repairers (72410)",
    "Welders and Related Machine Operators (72106)", "Construction Millwrights and Industrial Mechanics (72400)",
    "Heavy Equipment Operators (73400)", "Construction Trades Helpers and Labourers (75110)",
    "Truck Drivers (73300)", "Labourers in Metal Processing (95100)"
  ],
  "Human Capital - Work Experience": ["1 year full-time work experience", "2 years full-time work experience", "3 years full-time work experience", "4+ years full-time work experience", "International graduate exemption"],
  "Human Capital - Language Proficiency (TEER 0/1)": ["CLB/NCLC 9+", "CLB/NCLC 8", "CLB/NCLC 7", "CLB/NCLC 6"],
  "Human Capital - Language Proficiency (TEER 2/3)": ["CLB/NCLC 8+", "CLB/NCLC 7", "CLB/NCLC 6", "CLB/NCLC 5"],
  "Human Capital - Language Proficiency (TEER 4/5)": ["CLB/NCLC 7+", "CLB/NCLC 6", "CLB/NCLC 5", "CLB/NCLC 4"],
  "Human Capital - Education": ["Master's/PhD", "Bachelor's (3+ years)", "Post-secondary (1+ year)", "Canadian Secondary School Diploma"],
  "Human Capital - Intent to Reside": ["Submitted genuine statement", "Not submitted"],
  "Human Capital - Bonus Points": ["Previous Work/Study 1 year", "Previous Work/Study 2 years", "Previous Work/Study 3+ years", "Close Family in Community", "Community Involvement", "Property in Community", "Spouse/Common-law Experience"]
};

// 對應分數
const pointsMapping = {
  "Job Offer - Section": [10,15,10,15,15],
  "Job Offer - Occupation": [10,10,10,10,10,10,10,10,8,5,7,10,10,10,10,10,5,2,2],
  "Human Capital - Work Experience": [10,15,20,25,10],
  "Human Capital - Language Proficiency (TEER 0/1)": [25,20,15,10],
  "Human Capital - Language Proficiency (TEER 2/3)": [25,20,15,10],
  "Human Capital - Language Proficiency (TEER 4/5)": [25,20,15,10],
  "Human Capital - Education": [25,20,15,10],
  "Human Capital - Intent to Reside": [10,0],
  "Human Capital - Bonus Points": [2,4,6,2,2,2,3] // 可累計，最大 15
};

// 分數上限
const maxScores = {
  "Job Offer - Section": 15,
  "Job Offer - Occupation": 10,
  "Human Capital - Work Experience": 25,
  "Human Capital - Language Proficiency (TEER 0/1)": 25,
  "Human Capital - Language Proficiency (TEER 2/3)": 25,
  "Human Capital - Language Proficiency (TEER 4/5)": 25,
  "Human Capital - Education": 25,
  "Human Capital - Intent to Reside": 10,
  "Human Capital - Bonus Points": 15
};

// 生成表單
const calculatorDiv = document.getElementById('calculator');
const selectedValues = {};

for (const category in categories) {
  const h2 = document.createElement('h2');
  h2.innerText = category;
  calculatorDiv.appendChild(h2);

  if(category === "Human Capital - Bonus Points") {
    const checkboxGroup = document.createElement('div');
    checkboxGroup.className = 'checkbox-group';
    categories[category].forEach((option, idx) => {
      const label = document.createElement('label');
      const input = document.createElement('input');
      input.type = 'checkbox';
      input.value = option;
      input.dataset.idx = idx;
      label.appendChild(input);
      label.appendChild(document.createTextNode(' ' + option));
      checkboxGroup.appendChild(label);
    });
    calculatorDiv.appendChild(checkboxGroup);
    selectedValues[category] = checkboxGroup;
  } else {
    const select = document.createElement('select');
    categories[category].forEach(option => {
      const opt = document.createElement('option');
      opt.value = option;
      opt.innerText = option;
      select.appendChild(opt);
    });
    selectedValues[category] = select;
    calculatorDiv.appendChild(select);
  }
}

// 計算總分
let sectionScores = {}; // 儲存每區分數
function calculatePoints() {
  let jobOfferTotal = 0;
  let humanCapitalTotal = 0;
  sectionScores = {};

  for (const category in selectedValues) {
    let score = 0;
    if(category === "Human Capital - Bonus Points") {
      const checkboxes = selectedValues[category].querySelectorAll('input[type=checkbox]');
      checkboxes.forEach(cb => {
        if(cb.checked){
          score += pointsMapping[category][cb.dataset.idx];
        }
      });
      score = Math.min(score, maxScores[category]);
    } else {
      const select = selectedValues[category];
      const selectedOption = select.value;
      const index = categories[category].indexOf(selectedOption);
      score = Math.min(pointsMapping[category][index], maxScores[category]);
    }
    sectionScores[category] = score;

    if(category.startsWith("Job Offer")) jobOfferTotal += score;
    else humanCapitalTotal += score;
  }

  document.getElementById('result').innerHTML = `
    Total Points for Job Offer: ${Math.min(jobOfferTotal,25)} / 25<br>
    Human Capital Assessment: ${Math.min(humanCapitalTotal,100)} / 100
  `;

  document.getElementById('details').style.display = 'none'; // hide details initially
}

// 顯示/隱藏詳細分數
function toggleDetails(){
  const detailsDiv = document.getElementById('details');
  if(detailsDiv.style.display === 'none'){
    let detailText = '';
    for (const section in sectionScores) {
      detailText += `${section}: ${sectionScores[section]} / ${maxScores[section]}<br>`;
    }
    detailsDiv.innerHTML = detailText;
    detailsDiv.style.display = 'block';
  } else {
    detailsDiv.style.display = 'none';
  }
}
</script>
</body>
</html>
